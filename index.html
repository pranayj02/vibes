<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Izzuâ€™s Bunking Powertool</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      margin: 0;
      background: #fdfcff;
      padding: 20px;
    }
    header {
      text-align: center;
      margin-bottom: 20px;
    }
    .carousel {
      display: flex;
      overflow-x: auto;
      gap: 10px;
      padding: 10px;
      margin-bottom: 30px;
    }
    .carousel img {
      max-height: 180px;
      border-radius: 10px;
      flex-shrink: 0;
    }
    .subject-card {
      border: 1px solid #ccc;
      background: #fff;
      border-radius: 8px;
      padding: 10px;
      margin-bottom: 12px;
    }
    .subject-card h3 {
      margin: 0 0 6px;
    }
    .calendar {
      margin-top: 30px;
    }
    .calendar-grid {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      gap: 5px;
      margin-top: 10px;
    }
    .calendar-day {
      background: #fff;
      padding: 8px;
      border-radius: 6px;
      text-align: center;
      font-size: 14px;
      cursor: pointer;
      border: 1px solid #ddd;
    }
    .calendar-day.attended {
      background-color: #c8f7c5;
    }
    .calendar-day.bunked {
      background-color: #f9c0c0;
    }
    .calendar-day.today {
      outline: 2px solid gold;
    }
    .legend {
      display: flex;
      justify-content: center;
      margin-top: 10px;
      gap: 20px;
    }
    .legend div {
      display: flex;
      align-items: center;
      gap: 5px;
      font-size: 14px;
    }
    .dot {
      width: 12px;
      height: 12px;
      border-radius: 50%;
    }
    .dot.attended { background: #45cb78; }
    .dot.bunked   { background: #e14e4e; }
    .dot.upcoming { background: #ccc; }
  </style>
</head>
<body>
  <header>
    <h1>Izzuâ€™s Bunking Powertool</h1>
  </header>

  <!-- ðŸŽ  Carousel -->
  <div class="carousel">
    <img src="FE587BEE-B75A-4339-A4FC-4BDBE073A250.jpeg" />
    <img src="IMG_0330.jpeg" />
    <img src="IMG_3484.jpeg" />
    <img src="IMG_5178.jpeg" />
    <img src="IMG_5179.jpeg" />
    <img src="IMG_5180.jpeg" />
  </div>

  <!-- ðŸ“Š Subject-wise Stats -->
  <div id="subjectStats"></div>

  <!-- ðŸ“… Calendar -->
  <div class="calendar">
    <h2>ðŸ“… Global Calendar</h2>
    <div id="calendarGrid" class="calendar-grid"></div>
    <div class="legend">
      <div><div class="dot attended"></div>Attended</div>
      <div><div class="dot bunked"></div>Bunked</div>
      <div><div class="dot upcoming"></div>Upcoming</div>
    </div>
  </div>

  <script>
    const timetable = {
      "Design Dissertation - 1": [1],
      "Environmental Studies - 4": [1],
      "Arch. Design Studio - 8": [2, 3],
      "Theory & Design of Structures - 8": [3],
      "Allied Studio â€“ Town Planning": [4, 5],
      "Prof. Practice - 2": [4],
      "Building Construction - 8": [5],
      "Building Services - 6": [4],
    };

    const startDate = new Date("2025-06-10");
    const endDate = new Date("2025-10-03");
    const holidays = ["2025-08-15", "2025-09-19", "2025-10-02"];
    const attendanceData = {};

    Object.keys(timetable).forEach(subject => {
      attendanceData[subject] = {};
    });

    function getDates() {
      const days = [];
      let d = new Date(startDate);
      while (d <= endDate) {
        days.push(new Date(d));
        d.setDate(d.getDate() + 1);
      }
      return days;
    }

    function toggleAttendance(subject, dateStr) {
      const current = attendanceData[subject][dateStr];
      attendanceData[subject][dateStr] =
        current === "attended"
          ? "bunked"
          : current === "bunked"
          ? "attended"
          : "attended";
      renderStats();
      renderCalendar();
    }

    function renderStats() {
      const container = document.getElementById("subjectStats");
      container.innerHTML = "";

      Object.entries(attendanceData).forEach(([subject, records]) => {
        const total = Object.keys(records).length;
        const attended = Object.values(records).filter((v) => v === "attended").length;
        const bunked = Object.values(records).filter((v) => v === "bunked").length;
        const held = attended + bunked;
        const required = Math.ceil(0.75 * total);
        const canBunk = Math.max(0, attended + (total - held) - required);
        const mustAttend = Math.max(0, required - attended);

        const div = document.createElement("div");
        div.className = "subject-card";
        div.innerHTML = `
          <h3>${subject}</h3>
          <p>Held: ${held} / ${total} | Attended: ${attended} | Bunked: ${bunked}</p>
          <p>Can still bunk: ${canBunk} | Must attend: ${mustAttend}</p>
        `;
        container.appendChild(div);
      });
    }

    function renderCalendar() {
      const grid = document.getElementById("calendarGrid");
      grid.innerHTML = "";
      const days = getDates();

      days.forEach((date) => {
        const cell = document.createElement("div");
        const dStr = date.toISOString().slice(0, 10);
        cell.className = "calendar-day";
        const today = new Date().toDateString() === date.toDateString();
        if (today) cell.classList.add("today");

        const contents = [`<div>${date.getDate()}</div>`];

        Object.entries(timetable).forEach(([subject, classDays]) => {
          if (classDays.includes(date.getDay()) && !holidays.includes(dStr)) {
            const status = attendanceData[subject][dStr] || "upcoming";
            attendanceData[subject][dStr] = status;
            contents.push(
              `<div class="${status}" onclick="toggleAttendance('${subject}','${dStr}')">
                ${subject.split(" ")[0].slice(0, 4)}
              </div>`
            );
            if (status === "attended") cell.classList.add("attended");
            else if (status === "bunked") cell.classList.add("bunked");
          }
        });

        cell.innerHTML = contents.join("");
        grid.appendChild(cell);
      });
    }

    renderStats();
    renderCalendar();
  </script>
</body>
</html>